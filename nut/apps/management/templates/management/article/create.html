{% extends 'management/management_base.html' %}
{% load i18n staticfiles %}

{% block css %}
    <link href="{% static 'summernote/summernote.css' %}" rel="stylesheet">
{% endblock %}

{% block content %}

    <div class="row">
        <form class="well form-horizontal" method="post">
        {% csrf_token %}
            <fieldset>
                {% for field in forms %}
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="{{ field.id_for_label }}">{{ field.label }}:</label>
                        <div class="col-sm-10">
                            {{ field }}
                        </div>
                    </div>
                {% endfor %}
            </fieldset>

            <div class="form-group">
                <div class="col-sm-offset-2 col-sm-10">
{#                    <div class="btn-group">#}
                        <button type="submit" class="btn btn-primary btn-lg">{% trans 'save' %}</button>
                        <a class="btn btn-default btn-lg">{% trans 'preview' %}</a>
{#                    </div>#}
                </div>
            </div>
        </form>
    </div>
{% endblock %}

{% block js %}
    <script src="{% static 'summernote/summernote.min.js' %}"></script>
    <script>
    $(document).ready(function() {
        $('#summernote').summernote({
            height: 700,
            codemirror: { // codemirror options
{#                airMode: true,#}
                theme: 'spacelab'
            },
            focus: true,
            onImageUpload: function(file, editor, welEditable) {
                sendFile(file, editor, welEditable);
            },
            toolbar:[
                ['style',['style','bold','italic','underline','clear']],
                ['fontface',['fontname']],
                ['textsize',['fontsize']],
                ['color', ['color']],
                ['para', ['ul', 'ol', 'paragraph']],
                ['height', ['height']],
                ['insert', ['picture','link','video','table']]
            ]
        });
        function sendFile(file, editor, welEditable) {
            data = new FormData();
            data.append("file", file[0]);
            $.ajax({
                data: data,
                type: "POST",
                url: "{% url 'management_upload_image' %}",
                cache: false,
                contentType: false,
                processData: false,
                success: function(url) {
                    editor.insertImage(welEditable, url);
{#                    editor.insertImage(welEditable, url);#}
{#                    console.log(welEditable);#}
                }
            });
        }
    });
    </script>
{% endblock %}