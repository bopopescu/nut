{% extends 'web/base.html' %}
{% load i18n static %}

{% block title %}{% trans 'settings' %}{% endblock %}

{% block css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/web/jquery.fileupload.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/web/style.css' %}">
{% endblock %}

{% block content %}
    <div class="container edit_profile" id="settings">
        <div class="row">
            <div class="col-sm-3 col-xs-3 slide">
                {% include 'web/user/partial/settings_slide.html' %}
            </div>
            <div class="col-sm-9 col-xs-9 intorduce">
                {% block main %}
                    <p class="fs_24 fc_2 tab_way">编辑个人资料</p>
                    <div class="head">
                        {% include 'web/user/partial/avatar_upload.html' with user_context=user %}
                    </div>
                    <form method="post" action="{% url 'web_user_settings' %}" class="form-horizontal">{% csrf_token %}
                        <div class="edit_info_area">
                            <div class="edit_info clear">
                                <div class="form-group" style="display: none;">
                                    <p id="default_location_value">{{ profile_form.location.value }}</p>
                                    <p id="default_city_value">{{ profile_form.city.value }}</p>
                                </div>
                                <ul>
                                    <li class="fs_16 fc_2 table"><span class="title td">{{ profile_form.nickname.label }}</span>{{ profile_form.nickname }}</li>
                                    <li class="fs_16 fc_2 table"><span class="title td">{{ profile_form.email.label }}</span>{{ profile_form.email }}</li>
                                    <li class="fs_16 fc_2 intor table"><span class="title td">{{ profile_form.bio.label }}</span>{{ profile_form.bio }}</li>


                                    <li class="fs_16 fc_2 address table"><span class="title td">{{ profile_form.location.label }}</span>
                                        <div class="select_area td">
                                            {{ profile_form.location }}
                                            {{ profile_form.city }}
                                        </div>
                                    </li>
                                    <li class="fs_16 fc_2 table"><span class="title td">{{ profile_form.gender.label  }}</span>
                                        {{ profile_form.gender }}
                                    </li>
                                </ul>
                            </div>
                        </div>
{#                    </form>#}
{#                <h2>编辑个人资料</h2>#}
{#                <div class="row">#}
{#                    {% include 'web/user/partial/avatar_upload.html' with user_context=user %}#}
{#                </div>#}
{#                <br />#}
{#                <div class="row">#}
{#                     <form method="post" action="{% url 'web_user_settings' %}" class="form-horizontal">#}
{#                         {% csrf_token %}#}
{#                         <fieldset>#}
{#                             <div class="form-group">#}
{#                                <label class="col-sm-2 control-label" for="{{ profile_form.nickname.id_for_label }}">{{ profile_form.nickname.label }}</label>#}
{#                                <div class="col-xs-8 col-sm-6">#}
{#                                    {{ profile_form.nickname }}#}
{#                                </div>#}
{#                             </div>#}
{#                             <div class="form-group">#}
{#                                <label class="col-sm-2 control-label" for="{{ profile_form.email.id_for_label }}">{{ profile_form.email.label }}</label>#}
{#                                <div class="col-xs-8 col-sm-6">#}
{#                                    {{ profile_form.email }}#}
{#                                </div>#}
{#                             </div>#}
{#                             <div class="form-group">#}
{#                                <label class="col-sm-2 control-label" for="{{ profile_form.bio.id_for_label }}">{{ profile_form.bio.label }}</label>#}
{#                                <div class="col-xs-8 col-sm-6">#}
{#                                    {{ profile_form.bio }}#}
{#                                </div>#}
{#                             </div>#}
{##}
{#                             <div class="form-group" style="display: none;">#}
{#                                <p id="default_location_value">{{ profile_form.location.value }}</p>#}
{#                                <p id="default_city_value">{{ profile_form.city.value }}</p>#}
{#                             </div>#}
{##}
{#                             <div class="form-group">#}
{#                                <label class="col-sm-2 control-label" for="{{ profile_form.location.id_for_label }}" >{{ profile_form.location.label }}</label>#}
{#                                <div class="col-xs-4 col-sm-3">#}
{#                                    {{ profile_form.location }}#}
{#                                </div>#}
{#                                <div class="col-xs-4 col-sm-3">#}
{#                                    {{ profile_form.city }}#}
{#                                </div>#}
{#                             </div>#}
{##}
{#                            <div class="form-group">#}
{#                                <label class="col-sm-2 control-label" for="{{ profile_form.gender.id_for_label  }}">{{ profile_form.gender.label  }}</label>#}
{#                                <div class="col-sm-3">#}
{#                                    {{ profile_form.gender }}#}
{#                                {% for radio in profile_form.gender %}#}
{#                                    <label class="checkbox-inline">{{ radio.choice_label }} {{ radio.tag }}&nbsp; </label>#}
{#                                {% endfor %}#}
{#                                </div>#}
{#                            </div>#}
{#                         </fieldset>#}
                         <div class="submit_info clear">
{#                         <div class="form-group">#}
{#                             <div class="col-sm-offset-2 col-sm-4">#}
                                <button type="submit" class="bg_c_blue fs_16 fc_4 button_loca">{% trans "update profile" %}</button>
{#                             </div>#}
                         </div>
                     </form>
                </div>
                {% endblock %}
            </div>
        </div>
    </div>
{% endblock %}

{% block script %}
{#    <script src="https://blueimp.github.io/jQuery-File-Upload/js/vendor/jquery.ui.widget.js"></script>#}
    <script src="{% static 'js/web/jquery.ui.widget.js' %}"></script>
    <script src="{% static 'js/web/jquery.iframe-transport.js' %}"></script>
    <script src="{% static 'js/web/jquery.fileupload.js' %}"></script>
    <script src="{% static 'js/web/account.js' %}"></script>
    <script>
$(function () {
    $('#fileupload').fileupload({
        dataType: 'json',
        disableImageResize: /Android(?!.*Chrome)|Opera/.test(window.navigator && navigator.userAgent),
        imageMaxWidth: 800,
        imageMaxHeight: 800,
        imageCrop: true, // Force cropped images
        done: function (e, data) {
            $('#user-avatar').attr('src', data.result.avatar_url);
        }
    });
});
</script>
{% endblock %}